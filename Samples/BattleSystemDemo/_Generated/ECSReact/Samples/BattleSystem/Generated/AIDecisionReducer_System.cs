// <auto-generated>
// Generated by ECSReact ISystem Bridge Generator
// Source: AIDecisionReducer
// Type: IReducer
// Generated at: 2025-10-07 12:54:34
// Do not modify this file directly - changes will be lost on regeneration
// </auto-generated>

using Unity.Entities;
using Unity.Burst;
using Unity.Collections;
using ECSReact.Core;
using ECSReact.Samples.BattleSystem;

namespace ECSReact.Samples.BattleSystem
{
  /// <summary>
  /// Generated ISystem implementation for AIDecisionReducer.
  /// Type: IReducer
  /// State: AIThinkingState, Action: AIReadyToDecideAction
  /// </summary>
  [UpdateInGroup(typeof(ReducerSystemGroup))]
  [BurstCompile]
  public partial struct AIDecisionReducer_System : ISystem
  {
    private AIDecisionReducer logic;
    private EntityQuery actionQuery;

    [BurstCompile]
    public void OnCreate(ref SystemState state)
    {
      logic = new AIDecisionReducer();

      // Use EntityQueryBuilder for Burst compatibility
      var queryBuilder = new EntityQueryBuilder(Allocator.Temp)
        .WithAll<AIReadyToDecideAction, ActionTag>();
      actionQuery = state.GetEntityQuery(queryBuilder);
      queryBuilder.Dispose();

      state.RequireForUpdate<AIThinkingState>();
      state.RequireForUpdate(actionQuery);
    }

    [BurstCompile]
    public void OnUpdate(ref SystemState state)
    {
      var gameState = SystemAPI.GetSingletonRW<AIThinkingState>();

      // Process all actions sequentially with SystemAPI access
      foreach (var (action, tag) in SystemAPI.Query<RefRO<AIReadyToDecideAction>, RefRO<ActionTag>>())
      {
        logic.Execute(ref gameState.ValueRW, in action.ValueRO, ref state);
      }
    }

  }
}
